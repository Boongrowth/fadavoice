<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Full Article</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    body {
      font-family: 'Noto Sans', sans-serif;
      margin: 0;
      background: #f9f9f9;
      color: #333;
    }

    header {
      background: #007bff;
      color: white;
      padding: 15px;
      text-align: center;
      position: relative;
    }

    header h1 a {
      color: white;
      text-decoration: none;
    }

    .menu-toggle {
      position: absolute;
      left: 15px;
      top: 15px;
      background: none;
      color: white;
      font-size: 24px;
      border: none;
      cursor: pointer;
    }

    .navbar {
      display: none;
      background: #222;
      position: fixed;
      top: 0;
      left: 0;
      height: 100%;
      width: 250px;
      padding-top: 60px;
      z-index: 1000;
      flex-direction: column;
    }

    .navbar.active {
      display: flex;
    }

    .navbar a {
      color: white;
      padding: 15px;
      text-decoration: none;
      display: block;
      transition: 0.3s;
    }

    .navbar a:hover {
      background: #444;
    }

    .close-btn {
      position: absolute;
      right: 15px;
      top: 10px;
      font-size: 28px;
      color: white;
      cursor: pointer;
    }

    .container {
      max-width: 800px;
      margin: 30px auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .article-image img {
      width: 100%;
      border-radius: 10px;
      margin-bottom: 15px;
    }

    .article-details {
      font-size: 14px;
      color: #666;
      margin-bottom: 15px;
    }

    .article-title {
      font-size: 24px;
      color: #222;
      margin-bottom: 15px;
    }

    .article-content {
      font-size: 17px;
      line-height: 1.7;
      color: #444;
      margin-bottom: 25px;
    }

    .share-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
    }

    .share-buttons a,
    .copy-link-btn {
      background: #007bff;
      color: white;
      padding: 10px 12px;
      border-radius: 50%;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: 0.3s;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }

    .share-buttons a:hover,
    .copy-link-btn:hover {
      background: #0056b3;
    }

    .featured-section {
      margin-top: 40px;
    }

    .featured-posts {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(230px, 1fr));
      gap: 15px;
    }

    .featured-post-card {
      background: #f3f3f3;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 1px 5px rgba(0,0,0,0.1);
    }

    .featured-post-card img {
      width: 100%;
      height: 140px;
      object-fit: cover;
    }

    .featured-post-card h4 {
      margin: 10px;
      font-size: 16px;
    }

    .featured-post-card a {
      color: #007bff;
      text-decoration: none;
    }

    footer {
      background: #222;
      color: #aaa;
      text-align: center;
      padding: 20px;
      margin-top: 40px;
    }

    footer a {
      color: #aaa;
      text-decoration: none;
    }

    footer a:hover {
      color: white;
    }

    .social-icons a {
      color: white;
      margin: 0 10px;
      text-decoration: none;
    }

    /* ‚úÖ Toast Message */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #333;
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.4s ease;
      z-index: 1000;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <button class="menu-toggle">&#9776;</button>
    <h1><a href="index.html">Fada-Voice</a></h1>
  </header>

  <!-- NAVBAR -->
  <div class="navbar" id="navbar">
    <span class="close-btn" id="closeBtn">&times;</span>
    <a href="popular.html">Popular Post</a>
    <a href="featured.html">Featured Post</a>
    <a href="latest.html">Latest Post</a>
    <a href="about.html">About Us</a>
    <a href="privacy.html">Privacy Policy</a>
    <a href="advertise.html">Advertise with Us</a>
    <a href="contact.html">Contact Us</a>
  </div>

  <!-- ARTICLE -->
  <div class="container" id="articleContainer">
    <p>Loading article...</p>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="footer-links">
      <a href="about.html">About Us</a> | 
      <a href="privacy.html">Privacy Policy</a> | 
      <a href="advertise.html">Advertise</a> | 
      <a href="contact.html">Contact</a>
    </div>
    <div class="social-icons">
      <a href="#"><i class="fab fa-facebook-f"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-whatsapp"></i></a>
      <a href="#"><i class="fab fa-instagram"></i></a>
    </div>
  </footer>

  <div id="toast" class="toast">‚úÖ Link copied!</div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore-compat.js"></script>

  <script>
    // üîπ Navbar Toggle
    const menuToggle = document.querySelector('.menu-toggle');
    const navbar = document.getElementById('navbar');
    const closeBtn = document.getElementById('closeBtn');
    menuToggle.addEventListener('click', () => navbar.classList.add('active'));
    closeBtn.addEventListener('click', () => navbar.classList.remove('active'));

    // üîπ Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyAtVvPjdsj84mWqaG4-7SyjbljCnslZ1SM",
      authDomain: "hendaa-1.firebaseapp.com",
      projectId: "hendaa-1",
      storageBucket: "hendaa-1.appspot.com",
      messagingSenderId: "831134776479",
      appId: "1:831134776479:web:56cd7098fc69cd70a376aa"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const articleContainer = document.getElementById("articleContainer");
    const urlParams = new URLSearchParams(window.location.search);
    const articleId = urlParams.get("id");

    async function loadArticle() {
      if (!articleId) {
        articleContainer.innerHTML = "<p>Article not found.</p>";
        return;
      }

      const docRef = db.collection("newsPosts").doc(articleId);

      // Increment views
      await db.runTransaction(async (transaction) => {
        const docSnap = await transaction.get(docRef);
        if (!docSnap.exists) return;
        const views = docSnap.data().views || 0;
        transaction.update(docRef, { views: views + 1 });
      });

      const doc = await docRef.get();
      if (!doc.exists) {
        articleContainer.innerHTML = "<p>Article not found.</p>";
        return;
      }

      const article = doc.data();
      let authorName = "Unknown Author";
      let authorId = "";
      if (article.authorId) {
        const authorDoc = await db.collection("authors").doc(article.authorId).get();
        if (authorDoc.exists) {
          authorName = authorDoc.data().name;
          authorId = authorDoc.id;
        }
      }

      const publishedDate = new Date(article.timestamp).toLocaleDateString();

      articleContainer.innerHTML = `
        <div class="article-image">${article.imageUrl ? `<img src="${article.imageUrl}" alt="Article Image">` : ''}</div>
        <div class="article-details">
          <span>Category: ${article.category || 'N/A'}</span> | 
          <span>Published: ${publishedDate}</span> | 
          <span>Author: <a class="author-link" href="author.html?id=${authorId}">${authorName}</a></span> | 
          <span>üëÅÔ∏è Views: ${article.views ? article.views + 1 : 1}</span>
        </div>
        <h2 class="article-title">${article.title}</h2>
        <div class="article-content">${article.content.replace(/\n/g, '<br>')}</div>

        <div class="share-buttons">
          <a href="https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}" target="_blank" title="Share on Facebook"><i class="fab fa-facebook-f"></i></a>
          <a href="https://twitter.com/intent/tweet?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(article.title)}" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i></a>
          <a href="https://api.whatsapp.com/send?text=${encodeURIComponent(article.title + ' ' + window.location.href)}" target="_blank" title="Share on WhatsApp"><i class="fab fa-whatsapp"></i></a>
          <button id="copyLinkBtn" class="copy-link-btn" title="Copy Link"><i class="fas fa-link"></i></button>
        </div>

        <div class="featured-section">
          <h3>üåü Featured News</h3>
          <div class="featured-posts" id="featuredPosts">Loading featured posts...</div>
        </div>
      `;

      loadFeaturedPosts();
    }

    async function loadFeaturedPosts() {
      const featuredContainer = document.getElementById("featuredPosts");
      const snapshot = await db.collection("newsPosts")
        .where("isFeatured", "==", true)
        .limit(3)
        .get();
      if (snapshot.empty) {
        featuredContainer.innerHTML = "<p>No featured posts found.</p>";
        return;
      }
      featuredContainer.innerHTML = "";
      snapshot.forEach(doc => {
        const post = doc.data();
        const div = document.createElement("div");
        div.className = "featured-post-card";
        div.innerHTML = `
          ${post.imageUrl ? `<img src="${post.imageUrl}" alt="Post Image">` : ''}
          <h4><a href="post.html?id=${doc.id}">${post.title}</a></h4>
        `;
        featuredContainer.appendChild(div);
      });
    }

    // ‚úÖ Copy Link Functionality with Toast
    document.addEventListener("click", (e) => {
      if (e.target.closest("#copyLinkBtn")) {
        const title = document.querySelector(".article-title")?.innerText || document.title;
        const url = window.location.href;
        const textToCopy = `${title} - ${url}`;
        navigator.clipboard.writeText(textToCopy);

        const toast = document.getElementById("toast");
        toast.classList.add("show");
        setTimeout(() => toast.classList.remove("show"), 2500);
      }
    });

    loadArticle();
  </script>
</body>
</html>
